(function(){var xb,yb,T,G,zb,C,Ab,Bb,W,H,Cb,X,Db,Eb,Fb,Gb,Y,r,k,Z,l,aa,Hb,Ib,Jb,Kb,Lb,Mb,Nb,s,Ob,Pb,t,Qb,Rb,ba,Sb,I,Tb,Ub,Vb,J,K,L,u,Wb,ca,Xb,Yb,M,da,Zb,ea,N,$b,ac,bc,y,cc,dc,fa,ec,O,n,i,fc,P,Q,gc,R,ga,hc,ha,ic,q,jc,kc,ia,U,lc,pc={}.hasOwnProperty,e=function(a,b){function c(){this.constructor=a}for(var d in b)pc.call(b,d)&&(a[d]=b[d]);c.prototype=b.prototype;a.prototype=new c;a.__super__=b.prototype;return a};window.DEBUG=window.DEBUG||!1;if(!window.DEBUG){window.console||(window.console={});ia=["log",
"debug","warn","info"];U=0;for(lc=ia.length;U<lc;U++)kc=ia[U],console[kc]=function(){}}window.Handlebars.registerHelper("p",function(a){a.defaultValue();a=a.value();return new Handlebars.SafeString(a)});window.Handlebars.registerHelper("ps",function(a){var b;b=a.defaultValue();a=a.value();return b!==a?new Handlebars.SafeString(" "+a):new Handlebars.SafeString("")});window.Handlebars.registerHelper("pattr",function(a,b){var c,d;c=a.defaultValue();d=a.value();return c!==d?new Handlebars.SafeString(" "+
b+'="'+d+'"'):new Handlebars.SafeString("")});window.Handlebars.registerHelper("pcss",function(a,b){var c;a.defaultValue();return(c=a.value())&&""!==c?new Handlebars.SafeString(" "+b+": "+c+";"):new Handlebars.SafeString("")});var z=function(a){this.type=a;this.data={}};e(z,Backbone.View);z.prototype.renderTemplate=function(a,b){var c;c=$("#ds-widget-"+a).html();return Handlebars.compile(c)(b)};z.prototype.render=function(){var a,b;a=document.createElement("div");b=this.renderTemplate(this.type,this.data);
$(a).html(b);return this.setElement(a)};var v=function(a){v.__super__.constructor.call(this,"toggle");this.data=$.extend({},a)};e(v,z);v.prototype.events={"click .switch":"onToggleChanged"};v.prototype.onToggleChanged=function(a){return $(a.currentTarget).find("input").is(":checked")?this.trigger("valueChanged",this.data.onValue):this.trigger("valueChanged",this.data.offValue)};v.prototype.render=function(){var a;v.__super__.render.apply(this,arguments);a=this.$el.find(".switch");return a.switchbtn(a.data())};
v.prototype.setValue=function(){};q=v;var D=function(a){D.__super__.constructor.call(this,"select");this.data=$.extend({},a);this.data.items=a.items||[]};e(D,z);D.prototype.events={"change select":"onChange"};D.prototype.onChange=function(a){a=$(a.currentTarget).val();return this.trigger("valueChanged",a)};D.prototype.setValue=function(a){var b,c,d,f,o;f=this.data.items;o=[];c=0;for(d=f.length;c<d;c++)b=f[c],b.value===a?o.push(b.selected=!0):o.push(b.selected=!1);return o};n=D;var ja=function(){ja.__super__.constructor.call(this,
{items:[{value:"icon-glass",text:"glass"},{value:"icon-music",text:"music"},{value:"icon-search",text:"search"},{value:"icon-envelope",text:"envelope"},{value:"icon-heart",text:"heart"},{value:"icon-star",text:"star"},{value:"icon-star-empty",text:"star-empty"},{value:"icon-user",text:"user"},{value:"icon-film",text:"film"},{value:"icon-th-large",text:"th-large"},{value:"icon-th",text:"th"},{value:"icon-th-list",text:"th-list"},{value:"icon-ok",text:"ok"},{value:"icon-remove",text:"remove"},{value:"icon-zoom-in",
text:"zoom-in"},{value:"icon-zoom-out",text:"zoom-out"},{value:"icon-off",text:"off"},{value:"icon-signal",text:"signal"},{value:"icon-cog",text:"cog"},{value:"icon-trash",text:"trash"},{value:"icon-home",text:"home"},{value:"icon-file",text:"file"},{value:"icon-time",text:"time"},{value:"icon-road",text:"road"},{value:"icon-download-alt",text:"download-alt"},{value:"icon-download",text:"download"},{value:"icon-upload",text:"upload"},{value:"icon-inbox",text:"inbox"},{value:"icon-play-circle",text:"play-circle"},
{value:"icon-repeat",text:"repeat"},{value:"icon-refresh",text:"refresh"},{value:"icon-list-alt",text:"list-alt"},{value:"icon-lock",text:"lock"},{value:"icon-flag",text:"flag"},{value:"icon-headphones",text:"headphones"},{value:"icon-volume-off",text:"volume-off"},{value:"icon-volume-down",text:"volume-down"},{value:"icon-volume-up",text:"volume-up"},{value:"icon-qrcode",text:"qrcode"},{value:"icon-barcode",text:"barcode"},{value:"icon-tag",text:"tag"},{value:"icon-tags",text:"tags"},{value:"icon-book",
text:"book"},{value:"icon-bookmark",text:"bookmark"},{value:"icon-print",text:"print"},{value:"icon-camera",text:"camera"},{value:"icon-font",text:"font"},{value:"icon-bold",text:"bold"},{value:"icon-italic",text:"italic"},{value:"icon-text-height",text:"text-height"},{value:"icon-text-width",text:"text-width"},{value:"icon-align-left",text:"align-left"},{value:"icon-align-center",text:"align-center"},{value:"icon-align-right",text:"align-right"},{value:"icon-align-justify",text:"align-justify"},
{value:"icon-list",text:"list"},{value:"icon-indent-left",text:"indent-left"},{value:"icon-indent-right",text:"indent-right"},{value:"icon-facetime-video",text:"facetime-video"},{value:"icon-picture",text:"picture"},{value:"icon-pencil",text:"pencil"},{value:"icon-map-marker",text:"map-marker"},{value:"icon-adjust",text:"adjust"},{value:"icon-tint",text:"tint"},{value:"icon-edit",text:"edit"},{value:"icon-share",text:"share"},{value:"icon-check",text:"check"},{value:"icon-move",text:"move"},{value:"icon-step-backward",
text:"step-backward"},{value:"icon-fast-backward",text:"fast-backward"},{value:"icon-backward",text:"backward"},{value:"icon-play",text:"play"},{value:"icon-pause",text:"pause"},{value:"icon-stop",text:"stop"},{value:"icon-forward",text:"forward"},{value:"icon-fast-forward",text:"fast-forward"},{value:"icon-step-forward",text:"step-forward"},{value:"icon-eject",text:"eject"},{value:"icon-chevron-left",text:"chevron-left"},{value:"icon-chevron-right",text:"chevron-right"},{value:"icon-plus-sign",text:"plus-sign"},
{value:"icon-minus-sign",text:"minus-sign"},{value:"icon-remove-sign",text:"remove-sign"},{value:"icon-ok-sign",text:"ok-sign"},{value:"icon-question-sign",text:"question-sign"},{value:"icon-info-sign",text:"info-sign"},{value:"icon-screenshot",text:"screenshot"},{value:"icon-remove-circle",text:"remove-circle"},{value:"icon-ok-circle",text:"ok-circle"},{value:"icon-ban-circle",text:"ban-circle"},{value:"icon-arrow-left",text:"arrow-left"},{value:"icon-arrow-right",text:"arrow-right"},{value:"icon-arrow-up",
text:"arrow-up"},{value:"icon-arrow-down",text:"arrow-down"},{value:"icon-share-alt",text:"share-alt"},{value:"icon-resize-full",text:"resize-full"},{value:"icon-resize-small",text:"resize-small"},{value:"icon-plus",text:"plus"},{value:"icon-minus",text:"minus"},{value:"icon-asterisk",text:"asterisk"},{value:"icon-exclamation-sign",text:"exclamation-sign"},{value:"icon-gift",text:"gift"},{value:"icon-leaf",text:"leaf"},{value:"icon-fire",text:"fire"},{value:"icon-eye-open",text:"eye-open"},{value:"icon-eye-close",
text:"eye-close"},{value:"icon-warning-sign",text:"warning-sign"},{value:"icon-plane",text:"plane"},{value:"icon-calendar",text:"calendar"},{value:"icon-random",text:"random"},{value:"icon-comment",text:"comment"},{value:"icon-magnet",text:"magnet"},{value:"icon-chevron-up",text:"chevron-up"},{value:"icon-chevron-down",text:"chevron-down"},{value:"icon-retweet",text:"retweet"},{value:"icon-shopping-cart",text:"shopping-cart"},{value:"icon-folder-close",text:"folder-close"},{value:"icon-folder-open",
text:"folder-open"},{value:"icon-resize-vertical",text:"resize-vertical"},{value:"icon-resize-horizontal",text:"resize-horizontal"},{value:"icon-hdd",text:"hdd"},{value:"icon-bullhorn",text:"bullhorn"},{value:"icon-bell",text:"bell"},{value:"icon-certificate",text:"certificate"},{value:"icon-thumbs-up",text:"thumbs-up"},{value:"icon-thumbs-down",text:"thumbs-down"},{value:"icon-hand-right",text:"hand-right"},{value:"icon-hand-left",text:"hand-left"},{value:"icon-hand-up",text:"hand-up"},{value:"icon-hand-down",
text:"hand-down"},{value:"icon-circle-arrow-right",text:"circle-arrow-right"},{value:"icon-circle-arrow-left",text:"circle-arrow-left"},{value:"icon-circle-arrow-up",text:"circle-arrow-up"},{value:"icon-circle-arrow-down",text:"circle-arrow-down"},{value:"icon-globe",text:"globe"},{value:"icon-wrench",text:"wrench"},{value:"icon-tasks",text:"tasks"},{value:"icon-filter",text:"filter"},{value:"icon-briefcase",text:"briefcase"},{value:"icon-fullscreen",text:"fullscreen"}]})};e(ja,n);Ub=ja;var ka=function(){ka.__super__.constructor.call(this,
{items:[{value:"",text:"Default"},{value:"btn-primary",text:"Primary"},{value:"btn-info",text:"Info"},{value:"btn-success",text:"Success"},{value:"btn-warning",text:"Warning"},{value:"btn-danger",text:"Danger"},{value:"btn-inverse",text:"Inverse"}]})};e(ka,n);Gb=ka;var la=function(){la.__super__.constructor.call(this,{items:[{value:"",text:"Default"},{value:"btn-large",text:"Large"},{value:"btn-small",text:"Small"},{value:"btn-mini",text:"Mini"}]})};e(la,n);Eb=la;var ma=function(){ma.__super__.constructor.call(this,
{onText:"yes",onValue:"disabled",offText:"no",offValue:""})};e(ma,q);Ab=ma;var na=function(){na.__super__.constructor.call(this,{items:[{value:"",text:"Default"},{value:"alert-error",text:"Danger"},{value:"alert-success",text:"Success"},{value:"alert-info",text:"Info"}]})};e(na,n);yb=na;var oa=function(){oa.__super__.constructor.call(this,{items:[{value:"",text:"Default"},{value:"progress-success",text:"Success"},{value:"progress-warning",text:"Warning"},{value:"progress-danger",text:"Error"}]})};
e(oa,n);dc=oa;var E=function(){E.__super__.constructor.call(this,"singletext")};e(E,z);E.prototype.events={"keyup input":"onKeyUp"};E.prototype.onKeyUp=function(a){a=$(a.currentTarget).val();console.log("Text value changed",a);return this.trigger("valueChanged",a)};E.prototype.setValue=function(a){this.data.text=a;return $(this.el).find("input[type=text]").val(a)};i=E;var mc=function(a){mc.__super__.constructor.call(this,"button",{text:a})};e(mc,z);var A=function(a){var b;_.extend(this,Backbone.Events);
b=this;this.k=a.key;this.v=a.value;this.name=a.name;this.pos=a.pos;this.type=a.type;this.widgetdata=a.widgetdata;this.widget=new this.type(this.widgetdata);this.widget.setValue(this.v);this.widget.bind("valueChanged",function(a){var d;d=b.v;b.v=a;b.widget.setValue(a);return b.trigger("propertyChanged",d)});this.dv=this.v};A.prototype.key=function(){return this.k};A.prototype.value=function(){return this.v};A.prototype.defaultValue=function(){return this.dv};A.prototype.setValue=function(a){return this.v=
a};A.prototype.widget=function(){return this.widget};A.prototype.renderWidget=function(){return this.widget.render()};var nc=function(){};e(nc,Backbone.View);var V=function(a){this.control=a};e(V,nc);V.prototype.render=function(){var a,b,c,d,f;b=document.createElement("div");f=this.control.children;c=0;for(d=f.length;c<d;c++)a=f[c],a.render(),$(b,window.FrameDocument).append(a.renderer.renderedElement);return this.el=b};V.prototype.renderTo=function(a){var b,c,d,f,o,e;d=this.control.children;e=[];
f=0;for(o=d.length;f<o;f++)b=d[f],c=document.createElement("div"),b.renderer.renderTo(c),e.push($(a).append($(c).contents()));return e};var p=function(a){this.component=a};p.prototype.renderTemplate=function(a,b){var c;c=$("#ds-component-"+a).html();return Handlebars.compile(c)(b)};p.prototype.renderToBuffer=function(){var a;a=document.createElement("div");this.renderTo(a);return this.bufferedElement=$(a).contents()};p.prototype.renderTo=function(a){var b;b=$.extend({el_content:this.component.getContent},
this.component.propertyLookup);b=this.renderTemplate(this.component.type,b);$(a).html(b);b=document.createElement("div");this.component.layout.renderTo(b);return this.component.dropSelector?$(":first",a).find(this.component.dropSelector).append($(b).contents()):$(":first",a).append($(b).contents())};p.prototype.render=function(){var a,b;b=$.extend({el_content:this.component.getContent()},this.component.propertyLookup);a=this.renderTemplate(this.component.type,b);"page"!==this.component.type?(b=document.createElement("div"),
$(b,FrameDocument).html(a)):b=$("body",FrameDocument);0<b.children.length&&("page"!==this.component.type?(a=$(b,FrameDocument).children(),this.configureEditablePortion(this.component,a)):(a=$("body",FrameDocument),a.empty()),a.addClass("ds-component"),a.attr("data-componentid",this.component.componentid),this.renderedElement=a,this.component.layout.render(),this.placeLaidChildren(this.renderedElement,this.component.layout.el));return this.el=b};p.prototype.placeLaidChildren=function(a,b){var c;c=
$(b,window.FrameDocument).contents();return this.component.dropSelector?$(a).find(this.component.dropSelector).append(c):$(a).append(c)};p.prototype.configureEditablePortion=function(a,b){var c;if(!a.isContainer)return c=b.andSelf().find(a.editableSelector),c.attr("contenteditable",!0)};p.prototype.onHover=function(){return this.renderedElement.addClass("ds-hover")};p.prototype.onSelect=function(){return this.renderedElement.addClass("ds-selected")};p.prototype.onUnselect=function(){return this.renderedElement.removeClass("ds-selected")};
var h=function(a,b){this.type=a;this.name=b;this.componentid=null;this.propertyLookup={};this.parent=null;this.children=[];this.layout=new V(this);this.renderer=new p(this);this.isContainer=!1;this.p({name:"Id",key:"elementid",value:"",pos:0,type:i});this.p({name:"Class",key:"elementclass",value:"",pos:0,type:i});this.editableSelector="> *"};e(h,Backbone.View);h.prototype.p=function(a){var b,c;c=this;b=new A(a);b.bind("propertyChanged",function(a){return c.trigger("propertyChanged",b,a)});return this.propertyLookup[a.key]=
b};h.prototype.getValue=function(a){if(a in this.propertyLookup)return this.propertyLookup[a]};h.prototype.setValue=function(a,b){if(a in this.propertyLookup)return this.propertyLookup[a].setValue(b)};h.prototype.getProperties=function(){return this.propertyLookup};h.prototype.getContent=function(){return"DEFAULT"};h.prototype.duplicate=function(){var a,b,c,d,f;c=r.birth(this.type);f=c.getProperties();for(b in this.propertyLookup)if(a=this.propertyLookup[b],d=f[b])a=a.value(),$.isArray(a)?d.setValue($.extend(!0,
[],a)):"object"===typeof a?d.setValue($.extend(!0,{},a)):d.setValue(a);f=this.children;b=0;for(d=f.length;b<d;b++)a=f[b],a=a.duplicate(),c.appendChild(a);return c};h.prototype.onBirth=function(a){var b,c,d,f;c=[];c.push(this);for(f=[];c.length;)d=c.shift(),f.push(function(){var f,e,g,h;g=d.children;h=[];f=0;for(e=g.length;f<e;f++)b=g[f],b.componentid=r.newId(b.type),b.onBirth(a),a.register(b),h.push(c.splice(0,0,b));return h}());return f};h.prototype.prependChild=function(a){if(a===this)console.error("Can't add child of self!");
else return this.children.splice(0,0,a),a.parent=this,this.trigger("control.childrenChanged")};h.prototype.appendChild=function(a){if(a===this)console.error("Can't add child of self!");else return this.children.push(a),a.parent=this,this.trigger("control.childrenChanged")};h.prototype.insertChild=function(a,b){if(a===this)debugger;-1===b?this.children.push(a):this.children.splice(b,0,a);a.parent=this;return this.trigger("control.childrenChanged")};h.prototype.insertAfter=function(a,b){var c,d,f,o,
e;if(a===this)debugger;e=this.children;d=f=0;for(o=e.length;f<o;d=++f)if(c=e[d],c===b){this.children.splice(d+1,0,a);a.parent=this;return}return this.trigger("control.childrenChanged")};h.prototype.insertBefore=function(a,b){var c,d,f,e,m;if(a===this)debugger;m=this.children;d=f=0;for(e=m.length;f<e;d=++f)if(c=m[d],c===b){this.children.splice(d,0,a);a.parent=this;return}return this.trigger("control.childrenChanged")};h.prototype.removeChild=function(a){var b,c,d,f,e;e=this.children;c=d=0;for(f=e.length;d<
f;c=++d)if(b=e[c],b===a)return this.children.splice(c,1)};h.prototype.moveChild=function(a){var b,c,d,f,e,m;d=-1;m=this.children;c=f=0;for(e=m.length;f<e;c=++f)if(b=m[c],b===a){d=c;break}if(!(0>d))return a=this.children.splice(c,1),this.children.splice(d,0,a),d};h.prototype.getIndex=function(a){var b,c,d,f,e;e=this.children;c=d=0;for(f=e.length;d<f;c=++d)if(b=e[c],b===a)return c;return-1};h.prototype.render=function(){return this.renderer.render()};var w=function(a,b){w.__super__.constructor.call(this,
a,b);this.isContainer=!0;this.dropSelector=null;this._lastHoverIndex=-1;this._rejects=this._accepts=null};e(w,h);w.prototype.accept=function(a){this._accepts||(this._accepts={});return this._accepts[a]=1};w.prototype.reject=function(a){this._rejects||(this._rejects={});return this._rejects[a]=1};w.prototype.doesAccept=function(a){return this._rejects&&a in this._rejects||!this._accepts||a in this._accepts?!0:!1};w.prototype.onHover=function(a,b){var c,d,f,e,m,g,h;c=this.renderer.renderedElement.get(0);
$(".shim",c).remove();d=c.children;e=$(a.renderer.bufferedElement);e.addClass("shim");m=$(c);this.dropSelector&&(m=$(c).find(this.dropSelector));if(0>=d.length)m.append(a.renderer.bufferedElement);else{d=[];h=c.children;f=0;for(g=h.length;f<g;f++)c=h[f],d.push(c);f=g=0;for(h=d.length;g<h;f=++g)if(c=d[f],l.isBefore(c,b)){$(e).insertBefore(c);this._lastHoverIndex=f;return}m.append(e);return this._lastHoverIndex=-1}};w.prototype.onDrop=function(a){if(-1===this._lastHoverIndex)return this.appendChild(a),
this.getIndex(a);this.insertChild(a,this._lastHoverIndex);return this.getIndex(a)};k=w;var pa=function(a,b){pa.__super__.constructor.call(this,a,b);this.accept("_none_")};e(pa,k);Wb=pa;var qa=function(){qa.__super__.constructor.call(this,"container","Container")};e(qa,k);Z=qa;var ra=function(){ra.__super__.constructor.call(this,"content","Html Content");this.p({name:"Content",key:"content",value:"<p>Content</b>",type:i})};e(ra,h);I=ra;var sa=function(a,b){a||(a="link");b||(b="Link");sa.__super__.constructor.call(this,
a,b);this.p({name:"URL",key:"href",value:"#",pos:1,type:i});this.p({name:"Target",key:"target",value:"",pos:4,type:i});this.p({name:"Content",key:"content",value:"Link",type:i})};e(sa,h);u=sa;var ta=function(a,b){a||(a="button");b||(b="Button");ta.__super__.constructor.call(this,a,b);this.editableSelector="a";this.p({name:"Content",key:"content",value:"Click Me",pos:0,type:i});this.p({name:"URL",key:"href",value:"#",pos:1,type:i});this.p({name:"Type",key:"type",value:"",pos:2,type:Gb});this.p({name:"Size",
key:"size",value:"",pos:3,type:Eb});this.p({name:"Target",key:"target",value:"",pos:4,type:i});this.p({name:"Disabled",key:"disabled",value:"",pos:5,type:Ab})};e(ta,h);C=ta;var ua=function(a,b){var c,d,f;a||(a="buttongroup");b||(b="Button Group");ua.__super__.constructor.call(this,a,b);this.accept("button");c=new C;c.setValue("content","Button 1");d=new C;d.setValue("content","Button 2");f=new C;f.setValue("content","Button 3");this.appendChild(c);this.appendChild(d);this.appendChild(f)};e(ua,k);
Db=ua;var va=function(){va.__super__.constructor.call(this,"buttontoolbar","Button Toolbar");this.accept("buttongroup");this.accept("buttondropdown")};e(va,k);Fb=va;var B=function(){var a;B.__super__.constructor.call(this,"buttondropdown","Button Dropdown");this.accept("button");this.accept("buttondropdowntoggle");this.accept("buttondropdownlistitem");this.accept("buttondropdownlistitemdivider");a=new X;this.appendChild(a);a=new W;this.appendChild(a)};e(B,k);B.prototype.onHover=function(){B.__super__.onHover.apply(this,
arguments);return $(this.renderer.renderedElement).addClass("open")};B.prototype.render=function(){B.__super__.render.apply(this,arguments);return $(this.renderer.renderedElement).dropdown()};Bb=B;var wa=function(){wa.__super__.constructor.call(this,"buttondropdowntoggle","Button Dropdown Toggle")};e(wa,C);X=wa;var xa=function(){var a;xa.__super__.constructor.call(this,"buttondropdownlist","Button Dropdown List");a=new H;this.appendChild(a);a=new H;this.appendChild(a);a=new H;this.appendChild(a)};
e(xa,k);W=xa;var ya=function(){var a;ya.__super__.constructor.call(this,"buttondropdownlistitem","Button Dropdown Item");a=new u;this.appendChild(a)};e(ya,h);H=ya;var za=function(){return za.__super__.constructor.apply(this,arguments)};e(za,h);Cb=za;var Aa=function(){Aa.__super__.constructor.call(this,"icon","Icon");this.p({name:"Icon",key:"icon",value:"icon-glass",type:Ub})};e(Aa,h);Tb=Aa;var Ba=function(){Ba.__super__.constructor.call(this,"image","Image");this.p({name:"Src",key:"src",value:"http://i.imgur.com/Asf2J.jpg",
type:i});this.p({name:"Width",key:"width",value:"200px",type:i});this.p({name:"Height",key:"height",value:"261px",type:i})};e(Ba,h);Vb=Ba;var Ca=function(){Ca.__super__.constructor.call(this,"heading","Heading");this.p({name:"Content",key:"content",value:"Heading",pos:0,type:i});this.p({name:"Size",key:"size",value:3,type:i})};e(Ca,h);ba=Ca;var Da=function(){var a;Da.__super__.constructor.call(this,"pageheader","Page Header");a=new ba;this.appendChild(a);this.p({name:"Content",key:"content",value:"Heading 3",
pos:0,type:i})};e(Da,h);ac=Da;var Ea=function(){var a;Ea.__super__.constructor.call(this,"alert","Alert");a=new I;a.setValue("content","<h1>Hello, World!</h1><p>This is a template</p>");this.appendChild(a);this.p({name:"Type",key:"type",value:"",type:yb})};e(Ea,k);xb=Ea;var Fa=function(){Fa.__super__.constructor.call(this,"progressbar","Progress Bar");this.p({name:"Value",key:"value",value:69,type:i});this.p({name:"Type",key:"type",value:"",type:dc});this.p({name:"Striped",key:"striped",value:"",
type:q,widgetdata:{onText:"yes",onValue:"progress-striped",offText:"no",offValue:""}});this.p({name:"Animated",key:"animated",value:"",type:q,widgetdata:{onText:"yes",onValue:"active",offText:"no",offValue:""}})};e(Fa,h);cc=Fa;var Ga=function(){Ga.__super__.constructor.call(this,"hr","Horizontal Rule")};e(Ga,h);Rb=Ga;var Ha=function(){var a;Ha.__super__.constructor.call(this,"hero","Hero Unit");a=new I;a.setValue("content","<h1>Hello, World!</h1><p>I'm a super hero!</p>");this.appendChild(a)};e(Ha,
k);Sb=Ha;var Ia=function(){var a;Ia.__super__.constructor.call(this,"well","Well");a=new I;a.setValue("content","<h1>Hello, World!</h1><p>This is a template</p>");this.appendChild(a)};e(Ia,k);jc=Ia;var Ja=function(){var a;Ja.__super__.constructor.call(this,"tabs","Tabs");a=new P;a.link.setValue("content","Link 1");this.appendChild(a);a=new P;a.link.setValue("content","Link 2");this.appendChild(a);a=new P;a.link.setValue("content","Link 3");this.appendChild(a)};e(Ja,k);fc=Ja;var Ka=function(){Ka.__super__.constructor.call(this,
"tabitem","Tab Item");this.p({name:"Active",key:"active",value:"",type:q,widgetdata:{onText:"yes",onValue:"active",offText:"no",offValue:""}});this.link=new u;this.appendChild(this.link)};e(Ka,h);P=Ka;var La=function(){var a;La.__super__.constructor.call(this,"navbar","Nav Bar");this.dropSelector="> .navbar-inner > .container";a=new ca;this.appendChild(a);a=new da;this.appendChild(a);this.p({name:"Type",key:"type",value:"",type:n,widgetdata:{items:[{value:"",text:"Default"},{value:"navbar-inverse",
text:"Inverse"}]}});this.p({name:"Fixed mode",key:"fixedmode",value:"",type:n,widgetdata:{items:[{value:"",text:"Not fixed"},{value:"navbar-fixed-top",text:"Fixed Top"},{value:"navbar-fixed-bottom",text:"Fixed Bottom"}]}})};e(La,k);Xb=La;var Ma=function(){Ma.__super__.constructor.call(this,"navbarbrand","Nav Bar Brand");this.setValue("content","Brand")};e(Ma,u);ca=Ma;var Na=function(){var a;Na.__super__.constructor.call(this,"navbarlinks","Nav Links");a=new M;a.link.setValue("content","Link 1");this.appendChild(a);
a=new M;a.link.setValue("content","Link 2");this.appendChild(a);a=new M;a.link.setValue("content","Link 3");this.appendChild(a);this.p({name:"Alignment",key:"alignment",value:"",type:n,widgetdata:{items:[{value:"",text:"No float"},{value:"pull-left",text:"Left"},{value:"pull-right",text:"Right"}]}})};e(Na,k);da=Na;var Oa=function(){Oa.__super__.constructor.call(this,"navbarlinkitem","Nav Link Item");this.p({name:"Active",key:"active",value:"",type:q,widgetdata:{onText:"yes",onValue:"active",offText:"no",
offValue:""}});this.link=new u;this.appendChild(this.link)};e(Oa,h);M=Oa;var Pa=function(){Pa.__super__.constructor.call(this,"navbarlinkdivider","Nav Link Divider")};e(Pa,h);Yb=Pa;var Qa=function(){var a;Qa.__super__.constructor.call(this,"navlist","Nav List");a=new ea;a.setValue("content","Header");this.appendChild(a);a=new N;a.setValue("content","Item 1");this.appendChild(a);a=new N;a.setValue("content","Item 2");this.appendChild(a);a=new N;a.setValue("content","Item 3");this.appendChild(a)};e(Qa,
h);Zb=Qa;var Ra=function(){Ra.__super__.constructor.call(this,"navlistheader","Nav List Header");this.p({name:"Text",key:"text",value:"Header 1",type:i})};e(Ra,h);ea=Ra;var Sa=function(){var a;Sa.__super__.constructor.call(this,"navlistitem","Nav List Item");this.p({name:"Active",key:"active",value:"",type:q,widgetdata:{onText:"yes",onValue:"active",offText:"no",offValue:""}});a=new u;this.appendChild(a)};e(Sa,h);N=Sa;var Ta=function(){var a;Ta.__super__.constructor.call(this,"breadcrumbs","Breadcrumbs");
a=new G;this.appendChild(a);a.link.setValue("content","Playlists");a=new T;this.appendChild(a);a=new G;this.appendChild(a);a.link.setValue("content","Office");a=new T;this.appendChild(a);a=new G;this.appendChild(a);a.link.setValue("content","Rick Astley")};e(Ta,k);zb=Ta;var Ua=function(){Ua.__super__.constructor.call(this,"breadcrumbitem","Breadcrumb Item");this.link=new u;this.appendChild(this.link);this.p({name:"Active",key:"active",value:"",type:q,widgetdata:{onText:"yes",onValue:"active",offText:"no",
offValue:""}})};e(Ua,h);G=Ua;var Va=function(){Va.__super__.constructor.call(this,"breadcrumbdivider","Breadcrumb Divider")};e(Va,h);T=Va;var Wa=function(){var a,b;Wa.__super__.constructor.call(this,"pagination","Pagination");b=new y;this.appendChild(b);a.link.setValue("content","Prev");a=new y;this.appendChild(a);a.link.setValue("content","1");b=new y;this.appendChild(b);b.link.setValue("content","2");b=new y;this.appendChild(b);b.link.setValue("content","3");b=new y;this.appendChild(b);a.link.setValue("content",
"Next");this.p({name:"Alignment",key:"alignment",value:"",type:n,widgetdata:{items:[{value:"",text:"Left"},{value:"pagination-centered",text:"Center"},{value:"pagination-right",text:"Right"}]}})};e(Wa,k);bc=Wa;var Xa=function(){Xa.__super__.constructor.call(this,"paginationitem","Pagination Item");this.p({name:"Active",key:"active",value:"",type:q,widgetdata:{onText:"yes",onValue:"active",offText:"no",offValue:""}});this.link=new u;this.link.setValue("content","n");this.appendChild(this.link)};e(Xa,
k);y=Xa;var Ya=function(){Ya.__super__.constructor.call(this,"form","Form")};e(Ya,k);Jb=Ya;var S=function(a,b){S.__super__.constructor.call(this,a,b);this.p({name:"Name",key:"name",value:"",type:i})};e(S,h);S.prototype.onBirth=function(a){S.__super__.onBirth.call(this,a);this.setValue("name",this.componentid);return this.parent.children[0].setValue("for",this.componentid)};J=S;var Za=function(){Za.__super__.constructor.call(this,"textinput","Text Input")};e(Za,J);ga=Za;var $a=function(){var a,b,c;
$a.__super__.constructor.call(this,"selectinput","Select Input");a=new O;b=new O;c=new O;a.setValue("label","Option 1");a.setValue("value","val1");b.setValue("label","Option 2");b.setValue("value","val2");c.setValue("label","Option 3");c.setValue("value","val3")};e($a,J);fa=$a;var ab=function(){ab.__super__.constructor.call(this,"selectoption","Select Option");this.p({name:"Value",key:"value",value:"",type:i});this.p({name:"Label",key:"label",value:"Option",type:i})};e(ab,h);O=ab;var bb=function(){bb.__super__.constructor.call(this,
"fileinput","File Inut")};e(bb,J);aa=bb;var cb=function(){cb.__super__.constructor.call(this,"textarea","Textarea")};e(cb,J);ha=cb;var db=function(){db.__super__.constructor.call(this,"inputlabel","Input Label");this.p({name:"For",key:"for",value:"",type:i});this.p({name:"Content",key:"content",value:"Label",type:i})};e(db,h);L=db;var eb=function(a){eb.__super__.constructor.call(this,a)};e(eb,Wb);K=eb;var fb=function(){var a,b;fb.__super__.constructor.call(this,"textinputgroup","Input group");b=new L;
a=new ga;this.appendChild(b);this.appendChild(a)};e(fb,K);hc=fb;var gb=function(){var a,b;gb.__super__.constructor.call(this,"selectinputgroup","Input group");b=new L;a=new fa;this.appendChild(b);this.appendChild(a)};e(gb,K);ec=gb;var hb=function(){var a,b;hb.__super__.constructor.call(this,"fileinputgroup","Input group");b=new L;a=new aa;this.appendChild(b);this.appendChild(a)};e(hb,K);Hb=hb;var ib=function(){var a,b;ib.__super__.constructor.call(this,"textareainputgroup","Input group");b=new L;
a=new ha;this.appendChild(b);this.appendChild(a)};e(ib,K);ic=ib;var jb=function(){var a,b,c;jb.__super__.constructor.call(this,"table","Table");a=new R;b=new R;c=new R;this.appendChild(a);this.appendChild(b);this.appendChild(c)};e(jb,k);gc=jb;var kb=function(){var a,b,c;kb.__super__.constructor.call(this,"tablerow","Table Row");a=new Q;b=new Q;c=new Q;this.appendChild(a);this.appendChild(b);this.appendChild(c)};e(kb,k);R=kb;var lb=function(){lb.__super__.constructor.call(this,"tablecell","Table Cell")};
e(lb,k);Q=lb;var mb=function(){var a,b,c;mb.__super__.constructor.call(this,"gridrow","Grid Row");a=new s;b=new s;c=new s;this.appendChild(a);this.appendChild(b);this.appendChild(c)};e(mb,k);Qb=mb;var nb=function(){var a,b,c;nb.__super__.constructor.call(this,"fluidgridrow","Fluid Grid Row");a=new s;b=new s;c=new s;this.appendChild(a);this.appendChild(b);this.appendChild(c)};e(nb,k);Ib=nb;var ob=function(a,b){ob.__super__.constructor.call(this,a,b);this.p({name:"Size",key:"size",value:1,type:i});
this.p({name:"Content",key:"content",value:"",type:i})};e(ob,k);t=ob;var pb=function(){pb.__super__.constructor.call(this,"gridcol1","Span 1");this.p({name:"Size",key:"size",value:1,type:i})};e(pb,t);Lb=pb;var qb=function(){qb.__super__.constructor.call(this,"gridcol2","Span 2");this.p({name:"Size",key:"size",value:2,type:i})};e(qb,t);Mb=qb;var rb=function(){rb.__super__.constructor.call(this,"gridcol3","Span 3");this.p({name:"Size",key:"size",value:3,type:i})};e(rb,t);Nb=rb;var sb=function(){sb.__super__.constructor.call(this,
"gridcol4","Span 4");this.p({name:"Size",key:"size",value:4,type:i})};e(sb,t);s=sb;var tb=function(){tb.__super__.constructor.call(this,"gridcol6","Span 6");this.p({name:"Size",key:"size",value:6,type:i})};e(tb,t);Ob=tb;var ub=function(){ub.__super__.constructor.call(this,"gridcol8","Span 8");this.p({name:"Size",key:"size",value:8,type:i})};e(ub,t);Pb=ub;var vb=function(){vb.__super__.constructor.call(this,"gridcol12","Span 12");this.p({name:"Size",key:"size",value:12,type:i})};e(vb,t);Kb=vb;var wb=
function(){var a;wb.__super__.constructor.call(this,"page","Page");a=new Z;this.appendChild(a)};e(wb,k);$b=wb;var j=function(){var a,b;_.extend(this,Backbone.Events);this._componentMap={};this._css="";this._actionStack=[];this._redoStack=[];r.document=this;this.root=r.birth("page");b=r.birth("navbar");b.setValue("fixedmode","navbar-fixed-top");a=r.birth("hero");this.root.prependChild(b);this.root.children[1].appendChild(a)};j.ActionTypes={ADD:0,REMOVE:1,MOVE_TO:2,MOVE_FROM:3,PROPERTY_TO:4,PROPERTY_FROM:5};
j.prototype.pushAction=function(a){this._redoStack=[];return this._actionStack.push(a)};j.prototype.undo=function(){var a;if(a=this._actionStack.pop())return console.log("UNDO"),this.scriptAction(a.reaction,a),this._redoStack.push(a)};j.prototype.redo=function(){var a;if(a=this._redoStack.pop())return console.log("REDO"),this.scriptAction(a.action,a),this._actionStack.push(a)};j.prototype.scriptAction=function(a,b){switch(a){case j.ActionTypes.ADD:b.parent.insertChild(b.control,b.index);break;case j.ActionTypes.REMOVE:b.parent.removeChild(b.control);
break;case j.ActionTypes.MOVE_FROM:b.newParent.removeChild(b.control);b.oldParent.insertChild(b.control,b.oldPosition);break;case j.ActionTypes.MOVE_TO:b.oldParent.removeChild(b.control);b.newParent.insertChild(b.control,b.newPosition);break;case j.ActionTypes.PROPERTY_FROM:b.control.setValue(b.property.k,b.oldValue);break;case j.ActionTypes.PROPERTY_TO:b.control.setValue(b.property.k,b.newValue)}return this.trigger("documentChanged")};j.prototype.register=function(a){var b;b=this;this._componentMap[a.componentid]=
a;a.bind("propertyChanged",function(c,d){b.pushAction({action:j.ActionTypes.PROPERTY_TO,reaction:j.ActionTypes.PROPERTY_FROM,control:a,property:c,oldValue:d,newValue:c.value()});return b.trigger("documentChanged")});return console.log("Registered component",a.componentid,this._componentMap)};j.prototype.getComponent=function(a){return this._componentMap[a]};j.prototype.getFullHtml=function(){var a;a=this.getHtml();a='<!DOCTYPE html>\n<html lang="en">\n  <head>\n    <meta charset="utf-8">\n    <title></title>\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <meta name="description" content="">\n    <meta name="author" content="">\n\n    <\!-- Le styles --\>\n    <link href="assets/css/bootstrap.css" rel="stylesheet">\n    <style>\n      body {\n        padding-top: 60px; /* 60px to make the container go all the way to the bottom of the topbar */\n      }\n    </style>\n    <link href="assets/css/bootstrap-responsive.css" rel="stylesheet">\n\n    <\!-- Le HTML5 shim, for IE6-8 support of HTML5 elements --\>\n    <\!--[if lt IE 9]>\n    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"><\/script>\n    <![endif]--\>\n\n    <\!-- Le fav and touch icons --\>\n    <link rel="shortcut icon" href="assets/ico/favicon.ico">\n    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="assets/ico/apple-touch-icon-144-precomposed.png">\n    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="assets/ico/apple-touch-icon-114-precomposed.png">\n    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="assets/ico/apple-touch-icon-72-precomposed.png">\n    <link rel="apple-touch-icon-precomposed" href="assets/ico/apple-touch-icon-57-precomposed.png">\n    <style>\n'+
this._css+"\n    </style>\n  </head>\n  <body>\n"+a+'\n    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"><\/script>\n    <script src="assets/js/bootstrap.js"><\/script>\n  </body>\n</html>';return style_html(a,{indent_size:2,indent_char:" ",unformatted:["textarea"]})};j.prototype.getHtml=function(){var a,b;b=document.createElement("div");a=document.createElement("div");this.root.layout.renderTo(a);$(b).append($(a).contents());a=$(b).html();return style_html(a,{indent_size:2,
indent_char:" ",unformatted:["textarea"]})};j.prototype.setCss=function(a){return this._css=a};j.prototype.getRegisteredCssEntries=function(){var a,b,c,d,f,e,g;e=[];c=[];b=[];for(b.push(this.root);b.length;){a=b.shift();f=a.getValue("elementid").value();d=a.getValue("elementclass").value();""!==f&&e.push(f);""!==d&&c.push(d);g=a.children;d=0;for(f=g.length;d<f;d++)a=g[d],b.splice(0,0,a)}return{classes:c,ids:e}};Y={page:$b,content:I,container:Z,button:C,buttongroup:Db,buttontoolbar:Fb,buttondropdown:Bb,
buttondropdowntoggle:X,buttondropdownlist:W,buttondropdownlistitem:H,buttondropdownlistitemdivider:Cb,heading:ba,pageheader:ac,icon:Tb,image:Vb,alert:xb,progressbar:cc,hr:Rb,hero:Sb,well:jc,tabs:fc,tabitem:P,navbar:Xb,navbarbrand:ca,navbarlinks:da,navbarlinkitem:M,navbarlinkdivider:Yb,navlist:Zb,navlistheader:ea,navlistitem:N,breadcrumbs:zb,breadcrumbitem:G,breadcrumbdivider:T,pagination:bc,paginationitem:y,form:Jb,textinput:ga,textinputgroup:hc,selectinput:fa,selectoption:O,selectinputgroup:ec,fileinput:aa,
fileinputgroup:Hb,textareainputgroup:ic,textarea:ha,table:gc,tablerow:R,tablecell:Q,gridrow:Qb,fluidgridrow:Ib,gridcol1:Lb,gridcol2:Mb,gridcol3:Nb,gridcol4:s,gridcol6:Ob,gridcol8:Pb,gridcol12:Kb};var F=function(){};F.isAfter=function(a,b){var c,d,f;c=$(a);d=c.offset();f=c.outerWidth();c=c.outerHeight();d=[[d.left,d.top],[d.left+f,d.top],[d.left+f,d.top+c],[d.left,d.top+c]];c=d[0][1]+c/2;f=d[0][0]+f/2;return b.y>c&&b.y<d[2][1]||b.x>f&&b.x<d[1][0]};F.isBefore=function(a,b){var c,d;c=$(a);d=c.offset();
c.outerWidth();c=c.outerHeight();return b.y<d.top+c/2||b.x<d.left+20};F.elementContains=function(a,b){var c,d,f,e;f=a.offset();e=a.outerWidth();c=a.outerHeight();d=[0,0,0,0];return 0>d[3]&&0>d[1]&&b.x>f.left+e+-d[1]||b.x<f.left+d[3]||b.y>f.top+c||b.y<f.top||b.x>f.left+e||b.x<f.left||b.y>f.top+c||b.y<f.top?!1:!0};F.getComponentAt=function(a,b,c,d){var f,e,g,h,i,j;f=[];e=a;for(f.push(a);f.length;){a=f.shift();j=a.children;h=0;for(i=j.length;h<i;h++)if(a=j[h],(!c||a.isContainer)&&d!==a)g=a.renderer.renderedElement,
this.elementContains(g,b)&&(e=a,f.splice(0,0,a))}return e};F.eventToFramePoint=function(a){var b;b=$("#frame iframe").offset();return{x:a.pageX-b.left,y:Math.max(a.pageY-b.top,0)}};l=F;var x=function(){};x.document=null;x.typeCountMap={};x.count=0;x.build=function(a){if(a=Y[a])return a=new a,console.log("constructed new component",a),a};x.birth=function(a){var b;b=x.build(a);b.componentid=this.newId(a);this.document.register(b);b.onBirth(this.document);return b};x.newId=function(a){a in this.typeCountMap||
(this.typeCountMap[a]=0);return a+ ++this.typeCountMap[a]};r=x;var g=function(){var a;a=this;console.log("Starting builder");this._document=new j;this._document.bind("documentChanged",function(){a.redraw();clearTimeout(a._changeTimeout);return a._changeTimeout=setTimeout(function(){return a._updateCssEntries()},100)});$("#frame iframe").ready(function(){var b;b=function(){if(!window.FrameDocument||0===$("body",window.FrameDocument).length)return console.log("Still not loaded, waiting"),setTimeout(b,
20);console.log("Frame loaded, done waiting");return a._frameLoaded()};return setTimeout(b,20)})};e(g,Backbone.View);g.prototype._frameLoaded=function(){console.log("Frame loaded");this._document.root.render();this._initDialogs();this.sourceSelector="#components > ul > li > ul li";this.dropTarget="#frame-drop";this._initEvents();this._initDraggable();this._initDroppable();this._initHoverController();this._bindComponentEvents();this._bindUIEvents();return this._bindShortcuts()};g.prototype._initDialogs=
function(){var a,b,c,d;d=this;b=$("#components").detach().dialog({title:"Components",autoOpen:!1,width:300,height:400,position:[20,200],focus:function(){return $(this).closest(".ui-dialog").css({opacity:1})},close:function(){return d._minimizeComponents()}});b.parent(".ui-dialog").appendTo(".jqueryui");b.dialog("open");b.width(270);this.componentsDialog=b;c=!0;b=$("#properties").detach().dialog({title:"Properties",autoOpen:!1,width:300,height:300,position:[500,80],open:function(){var a;c&&(a=$(window).width(),
$(this).dialog("option","position",[a-340,100]));return c=!1}});b.parent(".ui-dialog").appendTo(".jqueryui");b.width(250);this.propertiesDialog=b;b=ace.edit("html-export-editor");a=require("ace/mode/html").Mode;b.getSession().setMode(new a);b.setReadOnly(!0);b.renderer.setHScrollBarAlwaysVisible(!1);b.renderer.setShowPrintMargin(!1);this._htmlExportEditor=b;b=ace.edit("css-editor-target");a=require("ace/mode/css").Mode;b.getSession().setMode(new a);b.renderer.setHScrollBarAlwaysVisible(!1);b.renderer.setShowPrintMargin(!1);
var f=this.cssEditor=b,e;e=null;return f.getSession().on("change",function(){clearTimeout(e);return e=setTimeout(function(){var a;a=f.getValue();return d.trigger("css.valueChanged",a)},500)})};g.prototype._minimizeComponents=function(){return $("#minimize-components").show()};g.prototype._bindComponentEvents=function(){var a;a=this;this.bind("dnd.drop",function(){a.redraw();return a._activeContainer=null});this.bind("dnd.selected",function(b){return a.selectComponent(b)});this.bind("dnd.doubleClicked",
function(b,c){return a.editComponentContent(b,c)});return this.bind("dnd.mousedown",function(a,c){return c.renderer.renderedElement.click(a)})};g.prototype._processWindowResize=function(){$("#frame-content").css("height",$(window).height());$("#css-editor-target").css("height",$(window).height()/2);return $("#css-editor").css("height",$(window).height()/2-50)};g.prototype._bindUIEvents=function(){var a;a=this;window.onbeforeunload=function(){return"Make sure to export before you leave, the alpha does not save"};
$(document).ready(function(){return a._processWindowResize()});this._watchMediaQueries();$(window).resize(this._processWindowResize);$("#toggle-boilerplate").click(function(){a._showBootstrapBoilerplate=$(this).is(":checked");return a._updateHtmlEditor()});$("#toggle-preview").click(function(b){b=$(b.currentTarget).find("input").is(":checked");return a._setPreviewMode(b)});$(document).on("click","#delete-component",function(){a.deleteSelectedComponent();return!1});$("#minimize-components").click(function(){$("#minimize-components").hide();
return a.componentsDialog.dialog("open")});$("#debug-dump-html").click(function(){a._updateHtmlEditor();$("#html-modal").modal("show");a._htmlExportEditor.resize();return $("#html-export-editor").height($("#html-modal .modal-body").height())});$("#show-tutorial").click(function(){$("#alpha-modal").modal("show");return!1});$("#show-css").click(function(){a._toggleCssEditor();return!1});$("#css-entry-add").click(function(){var b;if((b=$("#css-entry-select").val())&&""!==b)a.cssEditor.insert("\n"+b+
" {\n\n}"),b=a.cssEditor.selection.getCursor(),b=b.row,a.cssEditor.gotoLine(Math.max(0,b)),a.cssEditor.indent(),a.cssEditor.focus();return!1});$("#theme-select").change(function(){var b;b=$(this).val();return a._applyBootswatchTheme(b)});$("#export-zip").click(function(){var b;b=a._document.getFullHtml();return $.ajax({url:"/alpha/zip",type:"POST",data:{html:b},success:function(){var a;a=window.onbeforeunload;window.onbeforeunload=void 0;window.location="/alpha/zip/download";return setTimeout(function(){return window.onbeforeunload=
a},5E3)}})});$("header .size").click(function(){$("header .size").removeClass("selected");$(this).addClass("selected");$("#frame-content").removeClass("desktop laptop tablet phone").addClass($(this).data("size"));return!1});return $(document).on("click","#breadcrumbs > a",function(){var b;b=$(this).data("componentid");if(b=a._document.getComponent(b))return a.selectComponent(b)})};g.prototype._bindShortcuts=function(){var a;a=this;key("\u2318+d, ctrl+d","all",function(){a.duplicateActive();return!1});
key("\u2318+z,ctrl+z","all",function(){a._document.undo();return!1});key("\u2318+shift+z, ctrl+shift+z","all",function(){a._document.redo();return!1});key("\u2318+e, ctrl+e","all",function(){a["export"]();return!1});key("\u2318+c, ctrl+c","all",function(){a.copy();return!1});key("\u2318+v, ctrl+V","all",function(){a.paste();return!1});return key("delete, del, backspace","all",function(){a.deleteSelectedComponent();return!1})};g.prototype._setPreviewMode=function(a){if(this._isPreview=a)return this.hideDropFrame(),
$("[contenteditable]",window.FrameDocument).removeAttr("contenteditable"),$("body",window.FrameDocument).removeClass("design"),$(window.FrameDocument).on("click.external","a",function(){return!1});this.showDropFrame();$("body",window.FrameDocument).addClass("design");$(window.FrameDocument).die("click.external");return this.redraw()};g.prototype._watchMediaQueries=function(){var a;if(window.matchMedia)return a=window.matchMedia("(min-width: 1170px)"),a.addListener(function(a){if(a.matches)return console.log("Screen width 1170")})};
g.prototype.showDropFrame=function(){$("#frame-drop").removeClass("hidden");return this.clearSelection()};g.prototype.hideDropFrame=function(){$("#frame-drop").addClass("hidden");return this.clearSelection()};g.prototype._createTempComponent=function(a){a=Y[a];a=new a;a.renderer.renderToBuffer();return a};g.prototype._initEvents=function(){var a;a=this;this.bind("themes.bootswatch.updated",function(){var b,c,d,f,e;$("#theme-select").empty().append('<option value="">Default</option>');f=a._bootswatchThemes.themes;
e=[];c=0;for(d=f.length;c<d;c++)b=f[c],e.push($("#theme-select").append('<option value="'+b.name+'">'+b.name+"</option>"));return e});this.bind("css.valueChanged",function(b){a._document.setCss(b);return $("#custom-css",window.FrameDocument).replaceWith('<style id="custom-css">\n'+b+"\n</style>")});this.bind("dragStart",function(){var a;a=$("#toggle-preview input");if(a.is(":checked"))return a.parent().click()});return this.bind("dragStop",function(){a._activeComponent=null;a._activeContainer=null;
return $(".ds-tag",window.FrameDocument).remove()})};g.prototype._initDraggable=function(){var a;a=this;console.log("Creating draggable for",this.sourceSelector);return $(this.sourceSelector).draggable({appendTo:"body",cursorAt:{left:-2,top:-2},helper:function(){var b,c;$(this).text();c=$(this).data("type");a._activeComponent=a._createTempComponent(c);b=a._activeComponent.renderer.bufferedElement;b=$("<div></div>").append($(b).clone());b.data("type",c);b.children().first().css({position:"absolute"});
return b},start:function(b,c){var d;d=$(c.helper).data("type");console.log("Starting dragging controls",c);a._isDragging=!0;return a.trigger("dragStart",d)},stop:function(){console.log("Stopping dragging controls");a._isDragging=!1;a.trigger("dragStop");return a._dragStop()},revert:"invalid"})};g.prototype._initDroppable=function(){var a;a=this;$(this.dropTarget).mousemove(function(b){return a._dropMouseMove(b)});$(this.dropTarget).click(function(b){a._dropMouseClick(b);return b.preventDefault()});
$(this.dropTarget).dblclick(function(b){a._dropMouseDoubleClick(b);return b.preventDefault()});$(this.dropTarget).mousedown(function(b){a._dropMouseDown(b);return b.preventDefault()});return $(this.dropTarget).droppable({greedy:!0,tolerance:"pointer",activate:function(){},deactivate:function(){},over:function(){},out:function(){},drop:function(b){return a._drop(b)}})};g.prototype._dropTryScroll=function(a){if(!(a>dropHeight-60)({})&&!(60>a)({}))return{}};g.prototype._dropMouseDoubleClick=function(a){var b;
b=l.eventToFramePoint(a);b=l.getComponentAt(this._document.root,b);return this.trigger("dnd.doubleClicked",a,b)};g.prototype._dropMouseClick=function(a){a=l.eventToFramePoint(a);a=l.getComponentAt(this._document.root,a);return this.trigger("dnd.selected",a)};g.prototype._dropMouseMove=function(a){var b;b=l.eventToFramePoint(a);a=l.getComponentAt(this._document.root,b,!0,this._activeComponent);if(this._isDragging&&this._activeComponent&&a&&a.isContainer&&a.doesAccept(this._activeComponent.type)){$(".ds-hover",
window.FrameDocument).removeClass("ds-hover");this._activeContainer=a;if(this._activeContainer===this._activeComponent)debugger;return this._hoverContainer(a,b)}this._activeContainer=null;return this._hoverComponent(a,b)};g.prototype._dropMouseDown=function(a){var b;b=l.eventToFramePoint(a);if(b=l.getComponentAt(this._document.root,b,!1))return this.trigger("dnd.mousedown",a,b)};g.prototype._drop=function(a){var b;if(a.target!==$("#frame-drop").get(0))console.log("Not a real drop, ignoring");else if(l.eventToFramePoint(a),
!this._activeContainer||!this._activeComponent)console.error("not dropping, no container or component found");else return console.log("Dropping control",this._activeComponent,"on container",this._activeContainer),a=r.birth(this._activeComponent.type),$(".shim",window.FrameDocument).remove(),$(".ds-hover",window.FrameDocument).removeClass("ds-hover"),b=this._activeContainer.onDrop(a),this._document.pushAction({action:j.ActionTypes.ADD,reaction:j.ActionTypes.REMOVE,control:a,parent:this._activeContainer,
index:b}),this.showDropFrame(),this.trigger("dnd.drop",a)};g.prototype._redrop=function(a){var b,c,d;if(a.srcElement!==$("#frame-drop").get(0))console.log("Not a real drop, ignoring"),this.redraw();else if(d=l.eventToFramePoint(a),!this._activeContainer||!this._activeComponent)console.error("not dropping, no container or component found"),this.redraw();else return console.log("Dropping control",this._activeComponent,"on container",this._activeContainer),this._activeComponent.parent.removeChild(this._activeComponent),
a=this._activeComponent,$(".shim",window.FrameDocument).remove(),$(".ds-hover",window.FrameDocument).removeClass("ds-hover"),b=a.parent,c=a.parent.getIndex(a),this._activeContainer.onDrop(a),this._document.pushAction({action:j.ActionTypes.MOVE_TO,reaction:j.ActionTypes.MOVE_FROM,control:a,newParent:this._activeContainer,newPosition:this._activeContainer.getIndex(a),oldParent:b,oldPosition:c,point:d}),this.showDropFrame(),this.trigger("dnd.drop",a),this.redraw(),this.selectComponent(a)};g.prototype._dragStop=
function(){return $(".shim",window.FrameDocument).remove()};g.prototype._hoverContainer=function(a,b){var c;$(".ds-hover",window.FrameDocument).removeClass("ds-hover");if(this._activeComponent)return c=a.renderer.renderedElement,a.renderer.onHover(),c=$(c).offset(),$(".ds-tag",window.FrameDocument).remove(),$('<div class="ds-tag">'+a.name+"</div>").css({top:Math.max(0,c.top-20),left:c.left}).appendTo($("body",window.FrameDocument)),a.onHover(this._activeComponent,b)};g.prototype._hoverComponent=function(a){$(".ds-hover",
window.FrameDocument).removeClass("ds-hover");if("page"!==a.type&&"container"!==a.type)return this._lastHovered=a,a.renderer.onHover()};g.prototype._initHoverController=function(){var a,b,c,d,f;f=this;b=null;d=function(a,b,c){var d,a=f._activeComponent.renderer.renderedElement;$(a).position();d=b.x+c.x;b=b.y+c.y;$(a).outerWidth();$(a).outerHeight();return a.css({position:"absolute",left:d+"px",top:b+"px",width:$(a).width(),height:$(a).height(),zIndex:1E3})};a=function(a,c){var d,f;d=c.renderer.renderedElement;
$(d).addClass("ds-detached");f=$(d).offset();d.css({position:"absolute",left:f.left+"px",top:f.top+"px",width:$(d).width(),height:$(d).height(),zIndex:1E3});d.index();d.parent();d.detach();$("body",window.FrameDocument).append(d);return b=d};c=function(b,c){return a(b,c)};$.widget("jetstrap.controlHighlight",$.ui.mouse,{_init:function(){this._mouseInit();return this._lastPos=this._savedControl=null},_mouseStart:function(a){var b,d,e;console.log("START REDROPPING");this._mouseStarted=!1;e=l.eventToFramePoint(a);
b=f._activeComponent&&l.elementContains(f._activeComponent.renderer.renderedElement,e)?f._activeComponent:l.getComponentAt(f._document.root,e,!1);if(!("page"===b.type||"container"===b.type))if(console.log("Starting dragging on control",b.componentid),b.renderer.renderToBuffer(),d=b.parent){if(b)return f._activeComponent=b,d=$(b.renderer.renderedElement),d=d.position(),this._clickOffset={x:d.left-e.x,y:d.top-e.y},$(this.el).hide(),c(a,b);$(".shim").remove()}},_mouseDrag:function(a){var b;console.log("Dragging control",
a);if(f._activeComponent)return f._isDragging=!0,b=l.eventToFramePoint(a),this._lastPos||(this._lastPos=b),d(a,this._lastPos,this._clickOffset),this._lastPos=b,$(".shim").remove(),a=l.getComponentAt(f._document.root,b,!0,f._activeComponent),f._hoverContainer(a,b);f._isDragging=!1},_mouseStop:function(a){console.log("DONE REDROPPING");f._isDragging=!1;if(f._activeComponent&&b)return b.remove(),f._redrop(a)},_mouseDown:function(a){return $.ui.mouse.prototype._mouseDown.call(this,a)}});return $("#frame-drop").controlHighlight()};
g.prototype.clearSelection=function(){$(".shim",window.FrameDocument).remove();$(".ds-hover",window.FrameDocument).removeClass("ds-hover");$(".ds-selected",window.FrameDocument).removeClass("ds-selected");this._activeComponent=null;this.propertiesDialog.dialog("close");return this.hideBreadcrumbs()};g.prototype.selectComponent=function(a){this.clearSelection();if(!("page"===a.type||"container"===a.type))if(this._activeComponent=a)return this.showPropertiesFor(a),this.showBreadcrumbsFor(a),a.renderer.onSelect()};
g.prototype.deleteSelectedComponent=function(){if(this._activeComponent)return this._activeComponent.parent.removeChild(this._activeComponent),this.clearSelection(),this.redraw()};g.prototype.duplicateActive=function(){var a;if(this._activeComponent)return a=this._activeComponent.duplicate(),this._activeComponent.parent.insertAfter(a,this._activeComponent),this._document.pushAction({action:j.ActionTypes.ADD,reaction:j.ActionTypes.REMOVE,control:a,parent:this._activeComponent.parent}),this.redraw(),
this.selectComponent(a)};g.prototype["export"]=function(){this._updateHtmlEditor();$("#html-modal").modal("show");this._htmlExportEditor.resize();return $("#html-export-editor").height($("#html-modal .modal-body").height())};g.prototype.copy=function(){if(this._activeComponent)return this._copiedComponent=this._activeComponent};g.prototype.paste=function(){var a;if(this._copiedComponent&&this._activeComponent&&this._activeComponent.isContainer&&this._activeComponent.doesAccept(this._copiedComponent.type))return a=
this._copiedComponent.duplicate(),this._activeComponent.appendChild(a),this.redraw(),this.selectComponent(a)};g.prototype.showPropertiesFor=function(a){var b,c,d,e,g,h,i;e=a.getProperties();i=$("#properties");i.empty();i.append('<div><a href="#" id="delete-component" class="btn btn-small">Delete</a></div>');h=[];for(b in e)d=e[b],"content"!==d.key()&&(d.pos||(c=0),d.renderWidget(),g=$("<div><label>"+d.name+"</label></div>"),g.append(d.widget.el),i.append(g),h.splice(c,0,d));$("#properties").find(":input").attr("tabindex",
"-1");$("#properties").dialog("option","title",a.name);$("#properties").dialog("open");$("#properties").find(":input").attr("tabindex","1");return console.log("Showing sorted properties",h)};g.prototype._blurDialogs=function(){return $("#components").closest(".ui-dialog").css({opacity:0.5})};g.prototype.hideBreadcrumbs=function(){return $("#breadcrumbs").empty().addClass("hidden")};g.prototype.showBreadcrumbsFor=function(a){var b,c,d,e,g,h;b=$("#breadcrumbs");b.empty().removeClass("hidden");for(e=
[];a;)e.splice(0,0,a),a=a.parent;d=[];g=0;for(h=e.length;g<h;g++)a=e[g],c=a.name||a.type,d.push('<a href="#" data-componentid="'+a.componentid+'">'+c+"</a>");return b.html(d.join(" / "))};g.prototype.editComponentContent=function(a,b){var c;if(b)return this.hideDropFrame(),c=$(b.renderer.renderedElement),c.addClass("editable"),c.attr("data-button-class","all"),a.target=c.get(0),window.FrameWindow.etch.editableInit(a),$(b.renderer.renderedElement).focus()};g.prototype._showContentEditBox=function(a,
b,c){this._editBox||(this._editBox=$('<div class="ds-edit"><textarea resizable="false"></textarea></div>'),$("#frame-drop .relative").append(this._editBox),this._bindEditBoxEvents());this._editBox.css({display:"block",left:a.x,top:a.y,width:b,height:c});return this._editBox.find("textarea").focus()};g.prototype._bindEditBoxEvents=function(){var a;a=this;if(this._editBox)return this._editBox.bind("focusout",function(){return a._hideContentEditBox()})};g.prototype._hideContentEditBox=function(){this._editBox&&
this._editBox.hide();return this.showDropFrame()};g.prototype.editableFocusLost=function(a){var b,c;console.log("processing focus lost on element",a);if(!this._isPreview)return a&&((b=$(a).data("componentid"))||(b=$(a).closest("[data-componentid]").data("componentid")),b&&(c=$(a).find("*").andSelf().filter("[contenteditable]").removeAttr("contenteditable").html(),a=this._document.getComponent(b),a.setValue("content",c),console.log("Should apply changes for element",b,a,c))),this.showDropFrame(),$("#fake-editable").click()};
g.prototype.redraw=function(){var a;a=this._document.root;a.render();return a.renderer.renderedElement};g.prototype.setFrameSize=function(a,b){return $("#frame iframe").css({width:a,height:b})};g.prototype._updateHtmlEditor=function(){var a;a=this._document.getHtml();this._showBootstrapBoilerplate&&(a=this._document.getFullHtml());return this._htmlExportEditor.getSession().setValue(a)};g.prototype._updateCssEntries=function(){var a,b,c,d,e;a=this._document.getRegisteredCssEntries();$("#css-entry-select").empty();
e=a.ids;c=0;for(d=e.length;c<d;c++)b=e[c],$("#css-entry-select").append('<option value="#'+b+'">#'+b+"</option>");d=a.classes;e=[];b=0;for(c=d.length;b<c;b++)a=d[b],e.push($("#css-entry-select").append('<option value=".'+a+'">.'+a+"</option>"));return e};g.prototype._toggleCssEditor=function(){this.cssEditor.resize();return $("#css-editor").toggle()};g.prototype._getBootswatchThemes=function(){var a;a=this;return $.getJSON("http://api.bootswatch.com/",function(b){a._bootswatchThemes=b;return a.trigger("themes.bootswatch.updated")})};
g.prototype._applyBootswatchTheme=function(a){var b,c,d,e,g;console.log("Applying theme",a);$("#ds-custom-theme",window.FrameDocument).remove();e=this._bootswatchThemes.themes;g=[];c=0;for(d=e.length;c<d;c++)b=e[c],b.name===a?g.push($("head",window.FrameDocument).append('<link rel="stylesheet" id="ds-custom-theme" href="'+b.css+'" />')):g.push(void 0);return g};g.prototype.setBootswatchTheme=function(){};var oc=function(){this.builder=new g};oc.prototype.setFrameSize=function(a,b){return this.builder.setFrameSize(a,
b)};window.Jetstrap=new oc}).call(this);
